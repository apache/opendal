"use strict";(globalThis.webpackChunkopendal_website=globalThis.webpackChunkopendal_website||[]).push([[1764],{288(e,n,r){r.d(n,{R:()=>o,x:()=>a});var t=r(6363);const s={},i=t.createContext(s);function o(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(i.Provider,{value:n},e.children)}},403(e,n,r){r.r(n),r.d(n,{assets:()=>h,contentTitle:()=>d,default:()=>g,frontMatter:()=>c,metadata:()=>t,toc:()=>p});const t=JSON.parse('{"id":"bindings/nodejs","title":"Node.js","description":"","source":"@site/docs/20-bindings/nodejs.mdx","sourceDirName":"20-bindings","slug":"/bindings/nodejs","permalink":"/bindings/nodejs","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/opendal/tree/main/website/docs/20-bindings/nodejs.mdx","tags":[],"version":"current","lastUpdatedBy":"Xuanwo","lastUpdatedAt":1741601725000,"frontMatter":{"title":"Node.js"},"sidebar":"docs","previous":{"title":"Lua \ud83d\udea7","permalink":"/bindings/lua"},"next":{"title":"OCaml \ud83d\udea7","permalink":"/bindings/ocaml"}}');var s=r(7259),i=r(288),o=r(9860);function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"apache-opendal-nodejs-binding",children:"Apache OpenDAL\u2122 Node.js Binding"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/opendal",children:(0,s.jsx)(n.img,{src:"/img/external/6fc9234a805e6983d9cc27a62c8568aa.svg",alt:""})}),"\n",(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/opendal",children:(0,s.jsx)(n.img,{src:"/img/external/6a13f224a9ca353f3d7201919a549c91.svg",alt:"npm"})}),"\n",(0,s.jsx)(n.a,{href:"https://opendal.apache.org/docs/nodejs/",children:(0,s.jsx)(n.img,{src:"/img/external/0331140e6c28f97a21906ae8f1b0117b.svg",alt:"Website"})})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://github.com/apache/opendal/assets/5351546/87bbf6e5-f19e-449a-b368-3e283016c887",alt:""})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note"}),": This binding has its own independent version number, which may differ from the Rust core version. When checking for updates or compatibility, always refer to this binding's version rather than the core version."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"useful-links",children:"Useful Links"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://opendal.apache.org/docs/nodejs/",children:"Documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"./upgrade.md",children:"Upgrade Guide"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"npm install opendal\n"})}),"\n",(0,s.jsx)(n.h2,{id:"docs",children:"Docs"}),"\n",(0,s.jsx)(n.p,{children:"To build the docs locally, please run the following commands:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"# Only need to run once unless you want to update the docs theme\npnpm run build:theme\n\n# Build the docs\npnpm run docs\n"})}),"\n",(0,s.jsx)(n.h2,{id:"tests",children:"Tests"}),"\n",(0,s.jsxs)(n.p,{children:["Services behavior tests read necessary configs from env vars or the ",(0,s.jsx)(n.code,{children:".env"})," file."]}),"\n",(0,s.jsxs)(n.p,{children:["You can copy ",(0,s.jsx)(n.a,{href:"/.env.example",children:".env.example"})," to ",(0,s.jsx)(n.code,{children:"$(pwd)/.env"})," and change the values on need, or directly set env vars with ",(0,s.jsx)(n.code,{children:"export KEY=VALUE"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Take ",(0,s.jsx)(n.code,{children:"fs"})," for example, we need to enable bench on ",(0,s.jsx)(n.code,{children:"fs"})," on ",(0,s.jsx)(n.code,{children:"/tmp"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-properties",children:"OPENDAL_TEST=fs\nOPENDAL_FS_ROOT=/tmp\n"})}),"\n",(0,s.jsx)(n.p,{children:"You can run service behavior tests of enabled with the following command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"pnpm build && pnpm test\n"})}),"\n",(0,s.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'import { Operator } from "opendal";\n\nasync function main() {\n  const op = new Operator("fs", { root: "/tmp" });\n  await op.write("test", "Hello, World!");\n  const bs = await op.read("test");\n  console.log(new TextDecoder().decode(bs));\n  const meta = await op.stat("test");\n  console.log(`contentLength: ${meta.contentLength}`);\n}\n\nmain();\n'})}),"\n",(0,s.jsx)(n.h2,{id:"layers",children:"Layers"}),"\n",(0,s.jsx)(n.p,{children:"OpenDAL provides layers to add additional functionality to operators. You can chain multiple layers together to build powerful data access pipelines."}),"\n",(0,s.jsx)(n.h3,{id:"available-layers",children:"Available Layers"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"RetryLayer"})," - Retry failed operations automatically"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"ConcurrentLimitLayer"})," - Limit concurrent requests"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TimeoutLayer"})," - Add timeout for operations"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"LoggingLayer"})," - Log all operations"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"ThrottleLayer"})," - Limit bandwidth usage"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"timeoutlayer",children:"TimeoutLayer"}),"\n",(0,s.jsx)(n.p,{children:"Prevents operations from hanging indefinitely:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'import { Operator, TimeoutLayer } from "opendal";\n\nconst op = new Operator("fs", { root: "/tmp" });\n\nconst timeout = new TimeoutLayer();\ntimeout.timeout = 10000; // 10 seconds for non-IO operations (ms)\ntimeout.ioTimeout = 3000; // 3 seconds for IO operations (ms)\nop.layer(timeout.build());\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Default values:"})," timeout: 60s, ioTimeout: 10s"]}),"\n",(0,s.jsx)(n.h3,{id:"logginglayer",children:"LoggingLayer"}),"\n",(0,s.jsx)(n.p,{children:"Add structured logging for debugging and monitoring:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'import { Operator, LoggingLayer } from "opendal";\n\nconst op = new Operator("fs", { root: "/tmp" });\n\nconst logging = new LoggingLayer();\nop.layer(logging.build());\n\n// All operations will be logged\nawait op.write("test.txt", "Hello World");\n'})}),"\n",(0,s.jsx)(n.p,{children:"Enable logging output:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Show debug logs\nRUST_LOG=debug node app.js\n\n# Show only OpenDAL logs\nRUST_LOG=opendal::services=debug node app.js\n"})}),"\n",(0,s.jsx)(n.h3,{id:"throttlelayer",children:"ThrottleLayer"}),"\n",(0,s.jsx)(n.p,{children:"Control bandwidth usage with rate limiting:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'import { Operator, ThrottleLayer } from "opendal";\n\nconst op = new Operator("s3", {\n  bucket: "my-bucket",\n  region: "us-east-1",\n});\n\n// Limit to 10 KiB/s with 10 MiB burst\nconst throttle = new ThrottleLayer(10 * 1024, 10 * 1024 * 1024);\nop.layer(throttle.build());\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"bandwidth"}),": Maximum bytes per second"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"burst"}),": Maximum burst size (must be larger than any operation size)"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"retrylayer",children:"RetryLayer"}),"\n",(0,s.jsx)(n.p,{children:"Automatically retry temporary failed operations:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'import { Operator, RetryLayer } from "opendal";\n\nconst op = new Operator("s3", {\n  bucket: "my-bucket",\n  region: "us-east-1",\n});\n\nconst retry = new RetryLayer();\nretry.maxTimes = 3;\nretry.jitter = true;\nop.layer(retry.build());\n'})}),"\n",(0,s.jsx)(n.h3,{id:"concurrentlimitlayer",children:"ConcurrentLimitLayer"}),"\n",(0,s.jsx)(n.p,{children:"Limit concurrent requests to storage services:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'import { Operator, ConcurrentLimitLayer } from "opendal";\n\nconst op = new Operator("s3", {\n  bucket: "my-bucket",\n  region: "us-east-1",\n});\n\n// Allow max 1024 concurrent operations\nconst limit = new ConcurrentLimitLayer(1024);\nlimit.httpPermits = 512; // Limit HTTP requests separately\nop.layer(limit.build());\n'})}),"\n",(0,s.jsx)(n.h3,{id:"combining-multiple-layers",children:"Combining Multiple Layers"}),"\n",(0,s.jsx)(n.p,{children:"Stack multiple layers for comprehensive control:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'import {\n  Operator,\n  LoggingLayer,\n  TimeoutLayer,\n  RetryLayer,\n  ThrottleLayer,\n} from "opendal";\n\nconst op = new Operator("s3", {\n  bucket: "my-bucket",\n  region: "us-east-1",\n});\n\n// Layer 1: Logging for observability\nconst logging = new LoggingLayer();\nop.layer(logging.build());\n\n// Layer 2: Timeout protection\nconst timeout = new TimeoutLayer();\ntimeout.timeout = 30000;\ntimeout.ioTimeout = 10000;\nop.layer(timeout.build());\n\n// Layer 3: Retry on failures\nconst retry = new RetryLayer();\nretry.maxTimes = 3;\nretry.jitter = true;\nop.layer(retry.build());\n\n// Layer 4: Bandwidth throttling\nconst throttle = new ThrottleLayer(100 * 1024, 10 * 1024 * 1024);\nop.layer(throttle.build());\n\n// Now the operator has full production-ready protection\nawait op.write("data.json", JSON.stringify(data));\n'})}),"\n",(0,s.jsx)(n.h2,{id:"usage-with-nextjs",children:"Usage with Next.js"}),"\n",(0,s.jsxs)(n.p,{children:["Config automatically be bundled by ",(0,s.jsx)(n.a,{href:"https://nextjs.org/docs/app/api-reference/config/next-config-js/serverExternalPackages",children:"Next.js"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  serverExternalPackages: [\"opendal\"],\n};\n\nmodule.exports = nextConfig;\n"})}),"\n",(0,s.jsx)(n.h2,{id:"contributing",children:"Contributing"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Start with ",(0,s.jsx)(n.a,{href:"CONTRIBUTING.md",children:"Contributing Guide"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Submit ",(0,s.jsx)(n.a,{href:"https://github.com/apache/opendal/issues/new",children:"Issues"})," for bug report or feature requests."]}),"\n",(0,s.jsxs)(n.li,{children:["Asking questions in the ",(0,s.jsx)(n.a,{href:"https://github.com/apache/opendal/discussions/new?category=q-a",children:"Discussions"}),".\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Talk to community at ",(0,s.jsx)(n.a,{href:"https://opendal.apache.org/discord",children:"Discord"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"license-and-trademarks",children:"License and Trademarks"}),"\n",(0,s.jsxs)(n.p,{children:["Licensed under the Apache License, Version 2.0: ",(0,s.jsx)(n.a,{href:"http://www.apache.org/licenses/LICENSE-2.0",children:"http://www.apache.org/licenses/LICENSE-2.0"})]}),"\n",(0,s.jsx)(n.p,{children:"Apache OpenDAL, OpenDAL, and Apache are either registered trademarks or trademarks of the Apache Software Foundation."})]})}function l(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}const c={title:"Node.js"},d=void 0,h={},p=[{value:"Useful Links",id:"useful-links",level:2},{value:"Installation",id:"installation",level:2},{value:"Docs",id:"docs",level:2},{value:"Tests",id:"tests",level:2},{value:"Usage",id:"usage",level:2},{value:"Layers",id:"layers",level:2},{value:"Available Layers",id:"available-layers",level:3},{value:"TimeoutLayer",id:"timeoutlayer",level:3},{value:"LoggingLayer",id:"logginglayer",level:3},{value:"ThrottleLayer",id:"throttlelayer",level:3},{value:"RetryLayer",id:"retrylayer",level:3},{value:"ConcurrentLimitLayer",id:"concurrentlimitlayer",level:3},{value:"Combining Multiple Layers",id:"combining-multiple-layers",level:3},{value:"Usage with Next.js",id:"usage-with-nextjs",level:2},{value:"Contributing",id:"contributing",level:2},{value:"License and Trademarks",id:"license-and-trademarks",level:2}];function u(e){return(0,s.jsx)(o.A,{basePath:"bindings/nodejs/",children:(0,s.jsx)(l,{components:{h1:"h2"}})})}function g(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u()}},9860(e,n,r){r.d(n,{A:()=>i});var t=r(6363),s=r(7259);function i({children:e,owner:n="apache",repo:r="opendal",branch:i="main",basePath:o="",components:a={}}){const l=e=>{const t=e.replace(/^\.\//,"");return`https://github.com/${n}/${r}/blob/${i}/${o}${t}`},c={...a,a:e=>{const{href:n,...r}=e;return n&&n.startsWith("./")?(0,s.jsx)("a",{...r,href:l(n)}):(0,s.jsx)("a",{...e})},p:e=>{const{children:n}=e;if("string"==typeof n){const e=/\[(.*?)\]:\s*(\.\/[^\s]+)/g;if(e.test(n)){const r=n.replace(e,(e,n,r)=>`[${n}]: ${l(r)}`);return(0,s.jsx)("p",{children:r})}}return(0,s.jsx)("p",{...e})}};return"string"==typeof e?(e=>{if("string"!=typeof e)return e;let n=e.replace(/\[(.*?)\]\((\.\/[^)]+)\)/g,(e,n,r)=>`[${n}](${l(r)})`);return n=n.replace(/\[(.*?)\]:\s*(\.\/[^\s]+)/g,(e,n,r)=>`[${n}]: ${l(r)}`),n})(e):t.isValidElement(e)?t.cloneElement(e,{components:{...e.props.components||{},...c}}):e}}}]);